# Excel题库转Word试卷程序

这个程序可以将Excel格式的题库文件转换为Word格式的试卷。

## 功能特点

- 自动读取桌面上的"题库.xlsx"文件
- 支持多种题型（选择题、填空题、简答题等）
- 自动识别Excel文件的列结构
- 生成格式化的Word试卷
- 包含题号、分值、答案等信息
- 支持按题目类型分组显示

## 安装依赖

在运行程序之前，请先安装所需的Python包：

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas openpyxl python-docx
```

## 使用方法

### 1. 准备Excel题库文件

在桌面上创建一个名为"题库.xlsx"的Excel文件，包含以下列（列名可以自定义）：

- **题目类型**：题目的类型（如：选择题、填空题、简答题等）
- **题目内容**：题目的具体内容
- **选项A/B/C/D**：选择题的选项（填空题和简答题可以留空）
- **答案**：题目的正确答案
- **分值**：每道题的分值

### 2. 运行程序

```bash
python excel_to_word_exam.py
```

### 3. 查看结果

程序会在桌面上生成一个Word文件，文件名格式为：`试卷_YYYYMMDD_HHMMSS.docx`

## Excel文件格式示例

| 题目类型 | 题目内容 | 选项A | 选项B | 选项C | 选项D | 答案 | 分值 |
|---------|---------|-------|-------|-------|-------|------|------|
| 选择题 | 下列哪个是Python的内置数据类型？ | list | array | vector | sequence | A | 5 |
| 填空题 | Python中用于定义函数的关键字是_______。 | | | | | def | 3 |
| 简答题 | 请简述Python的特点。 | | | | | 简洁易读、跨平台、丰富的库等 | 10 |

## 程序特性

### 自动列识别
程序会自动识别Excel文件中的列名，支持以下关键词：
- 题目类型：包含"类型"或"type"
- 题目内容：包含"题目"、"内容"或"question"
- 选项：包含"选项"、"option"或单个字母A/B/C/D
- 答案：包含"答案"或"answer"
- 分值：包含"分值"、"分数"或"score"

### 智能格式化
- 自动添加题号和分隔线
- 按题目类型分组显示
- 设置合适的字体大小和格式
- 添加考试信息（时间、总分、考生信息等）

### 错误处理
- 自动检测文件是否存在
- 处理Excel文件读取错误
- 提供详细的错误信息

## 创建示例文件

如果您想先查看示例格式，可以运行：

```bash
python create_sample_excel.py
```

这将在桌面上创建一个示例Excel文件，您可以参考其格式来准备自己的题库。

## 注意事项

1. 确保桌面上有名为"题库.xlsx"的文件
2. Excel文件的第一行应该是列标题
3. 程序会自动处理空值和格式问题
4. 生成的Word文件会包含答案，适合教师使用
5. 如果需要学生版（不含答案），可以手动删除答案部分

## 故障排除

### 常见问题

1. **找不到Excel文件**
   - 确保文件名为"题库.xlsx"
   - 确保文件在桌面上

2. **读取Excel文件出错**
   - 检查文件格式是否正确
   - 确保文件没有被其他程序占用

3. **生成的Word文件格式不正确**
   - 检查Excel文件的列名是否符合要求
   - 确保数据格式正确

### 获取帮助

如果遇到问题，请检查：
- Python版本（建议3.7+）
- 依赖包是否正确安装
- Excel文件格式是否正确
- 文件路径是否正确

## 更新日志

- v1.0: 初始版本，支持基本的Excel到Word转换功能
- 支持多种题型和自动列识别
- 添加了示例文件生成功能 